= UTF8DOK: Plain Text, Powerful Docs
:author: UTF8DOK Team
:revdate: 2024-12-29
:slide-master: Corporate
:slide-bullets: 4
:toc: left
:toclevels: 2

[.slide]
== Executive Summary
:slide-layout: Title-And-Content

* High-performance AsciiDoc processor written in Rust
* Template-aware DOCX generation with round-trip editing
* Single source produces both documents and presentations
* Eclipse AsciiDoc TCK compliance target

[.document-only]
UTF8DOK is a next-generation documentation processor that bridges the gap between plain-text authoring and corporate document standards. Unlike traditional tools that generate documents from scratch, UTF8DOK injects content into existing `.dotx` templates, ensuring brand compliance while maintaining the simplicity of text-based authoring.

== The Problem We Solve

[.slide]
=== Corporate Documentation Challenges
:slide-bullets: 3

* Manual formatting wastes 30% of documentation time
* Brand inconsistency across document versions
* No single source of truth for content

[.document-only]
=== The Hidden Cost of Document Chaos

Organizations face a silent productivity drain: the constant battle between content creation and formatting. Technical writers spend hours wrestling with Word styles, only to have their carefully formatted documents broken by the next reviewer. Version control becomes a nightmare of "Final_v2_REALLY_FINAL.docx" files.

The root cause is a fundamental mismatch: modern content management demands text-based, diffable, versionable source files, while corporate distribution requires polished Office documents that match brand guidelines.

[.slide]
== How UTF8DOK Works
:slide-layout: Two-Content

* Write in AsciiDoc (plain text)
* Extract templates from existing DOCX
* Render to branded documents
* Round-trip: DOCX changes sync back

[.document-only]
=== The UTF8DOK Workflow

.Step 1: Extract
Start with an existing corporate document that matches your brand guidelines. UTF8DOK extracts both the content (as AsciiDoc) and the template (as .dotx), preserving all styles and formatting definitions.

.Step 2: Author
Write and edit your content in AsciiDoc format. Use any text editor, version control with Git, collaborate through pull requests. The content remains human-readable and diffable.

.Step 3: Render
Generate polished DOCX files by injecting your AsciiDoc content into the extracted template. Every heading, paragraph, and table inherits the correct corporate styles automatically.

.Step 4: Round-Trip
When stakeholders edit the DOCX directly, extract their changes back to AsciiDoc. The embedded source ensures lossless round-trips.

[.slide]
== Key Features
:slide-layout: Title-And-Content

* Template injection (not generation from scratch)
* Embedded source for round-trip editing
* Dual-nature: one source, two outputs
* Rhai plugin system for custom validation

[.document-only]
=== Feature Deep Dive

==== Template-Aware Generation

Traditional document generators create DOCX files from scratch, attempting to recreate corporate styles through configuration. This approach invariably fails to capture the nuances of professional templates: custom fonts, precise spacing, header/footer layouts, and branded color schemes.

UTF8DOK takes a fundamentally different approach. By starting with your actual corporate template, it preserves every formatting detail while only replacing the content. The result is indistinguishable from a document created manually in Word.

==== Self-Contained Documents

Every DOCX generated by UTF8DOK embeds its source AsciiDoc and configuration in a hidden `utf8dok/` folder within the archive. This means:

* Any UTF8DOK document can be extracted back to source
* No separate source files to track
* Complete audit trail of document origins

==== Dual-Nature Documents

This very document demonstrates UTF8DOK's dual-nature capability. The same source file produces:

* *Document version*: Detailed explanations, full context, comprehensive analysis
* *Slide version*: Executive bullets, key points, presentation-ready content

Content selectors (`[.slide]`, `[.document-only]`) control what appears where, while structural overrides (`:slide-bullets:`) fine-tune the output.

[.slide]
== Architecture Overview
:slide-layout: Title-And-Content

* Modular Rust workspace (9 crates)
* PEG parser with pest grammar
* LSP server for IDE integration
* WASM bindings for web deployment

[.document-only]
=== Technical Architecture

UTF8DOK is built as a Rust workspace with clear separation of concerns:

[cols="2,3",options="header"]
|===
|Crate |Purpose
|utf8dok-core |Parser, AST, diagnostics
|utf8dok-ast |Abstract syntax tree definitions
|utf8dok-ooxml |DOCX/DOTX reading and writing
|utf8dok-validate |Document validation engine
|utf8dok-plugins |Rhai scripting integration
|utf8dok-lsp |Language Server Protocol
|utf8dok-cli |Command-line interface
|utf8dok-wasm |WebAssembly bindings
|utf8dok-diagrams |Diagram rendering (Mermaid, Kroki)
|===

The architecture prioritizes:

* *Performance*: Native Rust speed, zero-copy parsing where possible
* *Correctness*: TCK-first development against Eclipse AsciiDoc specification
* *Extensibility*: Plugin system for custom validation rules

[.slide]
== CLI Commands
:slide-layout: Title-And-Content

* `utf8dok init` - Scaffold new workspace
* `utf8dok extract` - DOCX to AsciiDoc
* `utf8dok render` - AsciiDoc to DOCX
* `utf8dok dual-nature` - Analyze slide/doc views

[.document-only]
=== Command Reference

.Initialize a new workspace
[source,bash]
----
utf8dok init my-docs --template bridge
----

.Extract from existing DOCX
[source,bash]
----
utf8dok extract corporate-report.docx --output project/
----

.Render to DOCX
[source,bash]
----
utf8dok render document.adoc --template corporate.dotx
----

.Analyze dual-nature document
[source,bash]
----
utf8dok dual-nature presentation.adoc --target both
----

.Audit workspace compliance
[source,bash]
----
utf8dok audit docs/ --strict --format json
----

[.slide]
== Validation & Compliance
:slide-layout: Title-And-Content

* Built-in validators (hierarchy, links, images)
* Rhai plugins for custom rules
* Compliance dashboard with scoring
* CI/CD integration with exit codes

[.document-only]
=== Ensuring Documentation Quality

UTF8DOK includes a comprehensive validation system:

.Built-in Validators
* Section hierarchy (no skipped levels)
* Cross-reference integrity
* Image file existence
* Writing quality (weasel words, passive voice)

.Custom Validation with Rhai
[source,rhai]
----
// Custom rule: ADRs must have status
fn validate(doc) {
    let issues = [];
    if doc.has_attribute("adr") && !doc.has_attribute("status") {
        issues.push(error("ADR missing :status: attribute"));
    }
    issues
}
----

.Compliance Dashboard
Generate HTML reports showing documentation health across your entire workspace, with trend tracking and actionable recommendations.

[.slide]
== What's Next
:slide-layout: Title-And-Content

* PPTX renderer (native PowerPoint generation)
* VS Code extension with dual-pane preview
* Real-time collaboration features
* Enterprise template marketplace

[.document-only]
=== Roadmap

The dual-nature foundation opens exciting possibilities:

.Near Term
* Native PPTX generation from slide-annotated content
* VS Code extension showing document and slide views side-by-side
* Enhanced speaker notes generation from document content

.Medium Term
* Real-time collaborative editing with conflict resolution
* Template marketplace for enterprise customers
* Integration with documentation platforms (Confluence, Notion)

.Long Term
* AI-assisted content transformation between views
* Automated accessibility compliance checking
* Multi-language documentation with translation memory

[.slide]
== Get Started Today
:slide-layout: Title-And-Content

* Install: `cargo install utf8dok`
* Initialize: `utf8dok init my-docs`
* Documentation: https://github.com/alanbld/utf8dok

[.document-only]
=== Quick Start Guide

.Installation
[source,bash]
----
# From crates.io (coming soon)
cargo install utf8dok

# From source
git clone https://github.com/alanbld/utf8dok
cd utf8dok
cargo build --release
----

.Your First Document
[source,bash]
----
# Create a new workspace
utf8dok init my-docs --template bridge

# Navigate to workspace
cd my-docs

# Check compliance
utf8dok audit

# Generate dashboard
utf8dok dashboard
----

.Getting Help
* GitHub Issues: https://github.com/alanbld/utf8dok/issues
* Documentation: See `docs/manual.adoc` in the repository

---

_This document was created with UTF8DOK, demonstrating its dual-nature capability._
